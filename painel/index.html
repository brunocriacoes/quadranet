<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title> Quadra NET </title>
    <link rel="stylesheet" href="./disc/css/style.css">
    <link rel="stylesheet" href="./disc/css/mobile.css" media="( max-width: 760px )">
    <link rel="shortcut icon" href="./disc/logo/ico.png" type="image/x-icon">
</head>

<body>

    <div id="login">
        <div>
            <img src="./disc/logo/logo-box.png" alt="Quadra NET">
            <span>Seja Bem Vindo(a) ao QuadraNET.</span>
        </div>
        <section>
            <div>
                <h1></h1>
                <a href="http://www.sistemaquadralocacao.com.br">mais detalhes</a>
            </div>
        </section>
    </div>

    <div id="help" onclick="this.innerHTML = ''"></div>

    <script src="./disc/js/config.js"></script>
    <script src="./disc/js/router.js"></script>
    <script src="./disc/js/form.js"></script>
    <script src="./disc/js/interface.js"></script>
    <script src="./disc/js/table.js"></script>
    <script src="./disc/js/api.js"></script>

    <script>

        const api = new Api( uri_api, uri_admin );
        const log = console.log;
        api.send( 'pages/login', '', x => {
            let login = document.querySelector('#login div');
            let form = new Formulario(x);
            login.innerHTML += form.html();
        } );
        function sendApi( EL ) {
            api.send( 'auth', `${EL}&_method=POST`, x => {
                if ( ! x.error ) {
                    let data = new Date();
                    let hoje = data.toLocaleDateString("pt-BR").split( '/' ).reverse().join( '-' );
                    localStorage.setItem( 'token', x.token );
                    window.location.href = './dash.html';
                    localStorage.setItem( 'dominio', '' );
                    localStorage.setItem( 'data', hoje );
                } else {
                    Formulario.abilite();
                    document.querySelector( '#help' ).innerHTML = 'Usuario ou senha errado';
                }
            } );
        }
        api.send( 'calendarios', '', x => {
            localStorage.setItem( 'calendario',JSON.stringify(x) );
        } );
    </script>

</body>
</html>